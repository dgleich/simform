Generate a small database for testing
-----------

    make setup_database variable=TEMP dir=hdfs://icme-hadoop1.localdomain/user/jatempl/random_media/run? outdir=hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbsmall name=dbsmall

Change it's input file

    make -f dbsmall preprocess

    bash make_db_small_input.sh

    hadoop fs -rm hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbsmall/input.txt
    hadoop fs -put input.txt hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbsmall/input.txt

Convert it to seq files

    make -f dbsmall convert
    
Check the timesteps    
    
    python mr_seq_timestep_check.py \
    hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbsmall/data.seq/random_media/random_media*.seq \
    -r hadoop --no-output --variable TEMP -o hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbsmall/timesteps.seq
    
    dumbo cat hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbsmall/timesteps.seq

The output of this file is:

timestep index     time step     simulation number


Full database
-------------



Create the time-steps file to normalize all the times:

    cat tsteps.txt
    1250.0
    1350.0
    1450.0
    1550.0
    1650.0
    1750.0
    1850.0
    1950.0
    2000.0



Dump out the farface

time python mr_exodus2farface.py \
     hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbfull/input.txt \
        -r hadoop --python-archive simform-deploy.tar.gz \
        --variables TEMP -o
hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbfull/farface.txt
--no-output  \
        --jobconf mapred.line.input.format.linespermap=10
        
Took 
 2hrs, 24mins, 21sec        

Convert

Add jobconf linespermap=10 to dbfull

make -f runs convert timestepfile=tsteps.txt 

Time = 
real    883m10.961s



Tiny test
---------

    make setup_database variable=TEMP dir=hdfs://icme-hadoop1.localdomain/user/jatempl/random_media/run? outdir=hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbtest name=dbtest

   mv dbtest dbtest.dgleich

Add numParams?=16
    numExodusfiles?=16
    timesteps?=tstepstest.txt
    mr_seq2mseq2_hadoop.py -> mr_seq2mseq5_hadoop.py

     (5 is a special version to parse the parameter numbers correctly for this
one)

    make -f dbtest.dgleich preprocess


Use this timesteps file

cat tstepstest.txt 
1250.0
1650.0
2000.0

Fix up the input list

    bash make_db_test_input.sh

    hadoop fs -rm
hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbtest/input.txt
    hadoop fs -put inputtest.txt
hdfs://icme-hadoop1.localdomain/user/dgleich/rm-sisc/dbtest/input.txt i


